<!DOCTYPE html>
<html lang="zh">
  <head>
    <title>
        奥运会超级变变变生成器 - J4Muke StudiO
      </title>
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    
    <meta name="theme-color" content="#000000" />
    
    <meta http-equiv="window-target" content="_top" />
    
    
    <meta name="description" content="东京奥运会的超级变变变挺好玩，抖音上也有不少人做了模仿视频。 正好看到有人分享了日本小哥通过机器学习模仿摄像头生成视频的代码，修改后玩了一下，" />
    <meta name="generator" content="Hugo 0.87.0 with theme pure" />
    <title>奥运会超级变变变生成器 - J4Muke StudiO</title>
    
    
    <link rel="stylesheet" href="/css/style.min.084a5eb24fb0cf9d5aade7246f19ba0c820cf904996a28ffe88039427693ac68.css">
    
    <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.15.10/styles/github.min.css" async>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" async>
    <meta property="og:title" content="奥运会超级变变变生成器" />
<meta property="og:description" content="东京奥运会的超级变变变挺好玩，抖音上也有不少人做了模仿视频。 正好看到有人分享了日本小哥通过机器学习模仿摄像头生成视频的代码，修改后玩了一下，" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2021/08/tokoyo-kun/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-05T18:11:18+08:00" />
<meta property="article:modified_time" content="2021-08-05T18:11:18+08:00" />

<meta itemprop="name" content="奥运会超级变变变生成器">
<meta itemprop="description" content="东京奥运会的超级变变变挺好玩，抖音上也有不少人做了模仿视频。 正好看到有人分享了日本小哥通过机器学习模仿摄像头生成视频的代码，修改后玩了一下，"><meta itemprop="datePublished" content="2021-08-05T18:11:18+08:00" />
<meta itemprop="dateModified" content="2021-08-05T18:11:18+08:00" />
<meta itemprop="wordCount" content="2182">
<meta itemprop="keywords" content="代码,奥运会," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="奥运会超级变变变生成器"/>
<meta name="twitter:description" content="东京奥运会的超级变变变挺好玩，抖音上也有不少人做了模仿视频。 正好看到有人分享了日本小哥通过机器学习模仿摄像头生成视频的代码，修改后玩了一下，"/>

    <!--[if lte IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
      <![endif]-->

    <!--[if lt IE 9]>
        <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
      <![endif]-->
  </head>

  
  

  <body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="slimContent">
      <div class="navbar-header">
        <div class="profile-block text-center">
          <a id="avatar" href="https://weibo.com/u/3486501484" target="_blank">
            <img class="img-circle img-rotate" src="/avatar.png" width="200" height="200">
          </a>
          <h2 id="name" class="hidden-xs hidden-sm">J4Muke</h2>
          <h3 id="title" class="hidden-xs hidden-sm hidden-md">产品经理</h3>
          <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>Shanghai, China</small>
        </div><div class="search" id="search-form-wrap">
    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i
                        class="icon icon-search"></i></button>
            </span>
        </div>
        <div class="ins-search">
            <div class="ins-search-mask"></div>
            <div class="ins-search-container">
                <div class="ins-input-wrapper">
                    <input type="text" class="ins-search-input" placeholder="想要查找什么..."
                        x-webkit-speech />
                    <button type="button" class="close ins-close ins-selectable" data-dismiss="modal"
                        aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>
                <div class="ins-section-wrapper">
                    <div class="ins-section-container"></div>
                </div>
            </div>
        </div>
    </form>
</div>
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
        <ul class="nav navbar-nav main-nav">
            <li class="menu-item menu-item-home">
                <a href="/">
                    <i class="icon icon-home-fill"></i>
                  <span class="menu-title">Home</span>
                </a>
            </li>
            <li class="menu-item menu-item-archives">
                <a href="/posts/">
                    <i class="icon icon-archives-fill"></i>
                  <span class="menu-title">Archives</span>
                </a>
            </li>
            <li class="menu-item menu-item-categories">
                <a href="/categories/">
                    <i class="icon icon-folder"></i>
                  <span class="menu-title">Categories</span>
                </a>
            </li>
            <li class="menu-item menu-item-tags">
                <a href="/tags/">
                    <i class="icon icon-tags"></i>
                  <span class="menu-title">Tags</span>
                </a>
            </li>
            <li class="menu-item menu-item-about">
                <a href="/about/">
                    <i class="icon icon-cup-fill"></i>
                  <span class="menu-title">About</span>
                </a>
            </li>
        </ul>
      </nav>
    </div>
  </header>

<aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content"><p>日常想法的存档。</p>
            </div>
        </div>
    </div>
</div>

      <div class="widget">
    <h3 class="widget-title"> 标签</h3>
    <div id="tag-cloud-list" class="widget-body">
            
            
            <a href="/tags/dc%E6%BC%AB%E7%94%BB/" class="tag-list-link" rel="1">dc漫画<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/discord/" class="tag-list-link" rel="1">discord<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/facebook/" class="tag-list-link" rel="1">facebook<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/instagram/" class="tag-list-link" rel="1">instagram<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/netflix/" class="tag-list-link" rel="1">netflix<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E4%B8%AA%E6%80%A7%E5%8C%96%E6%8E%A8%E8%8D%90/" class="tag-list-link" rel="1">个性化推荐<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E4%BA%92%E5%8A%A8/" class="tag-list-link" rel="1">互动<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E4%BA%A7%E5%93%81/" class="tag-list-link" rel="5">产品<span
               class="tag-list-count">5</span></a>
            
            
            <a href="/tags/%E4%BA%A7%E5%93%81%E6%96%87%E6%A1%A3/" class="tag-list-link" rel="2">产品文档<span
               class="tag-list-count">2</span></a>
            
            
            <a href="/tags/%E4%BB%A3%E7%A0%81/" class="tag-list-link" rel="1">代码<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E5%85%83%E5%AE%87%E5%AE%99/" class="tag-list-link" rel="1">元宇宙<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E5%A5%A5%E8%BF%90%E4%BC%9A/" class="tag-list-link" rel="1">奥运会<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E6%83%B3%E6%B3%95/" class="tag-list-link" rel="1">想法<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E6%89%8E%E5%85%8B-%E6%96%BD%E8%80%90%E5%BE%B7/" class="tag-list-link" rel="1">扎克-施耐德<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/" class="tag-list-link" rel="1">数据统计<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E6%AD%A3%E4%B9%89%E8%81%94%E7%9B%9F/" class="tag-list-link" rel="1">正义联盟<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E6%B8%B8%E6%88%8F%E7%8E%A9%E6%B3%95/" class="tag-list-link" rel="1">游戏玩法<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E7%94%B5%E5%BD%B1/" class="tag-list-link" rel="1">电影<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E7%A4%BE%E4%BA%A4%E8%BD%AF%E4%BB%B6/" class="tag-list-link" rel="1">社交软件<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E7%AE%97%E6%B3%95/" class="tag-list-link" rel="1">算法<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/" class="tag-list-link" rel="1">编程思想<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E8%AF%BB%E5%90%8E%E6%84%9F/" class="tag-list-link" rel="1">读后感<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E8%B6%B3%E7%90%83/" class="tag-list-link" rel="1">足球<span
               class="tag-list-count">1</span></a>
            
            
            <a href="/tags/%E8%BF%90%E8%90%A5/" class="tag-list-link" rel="1">运营<span
               class="tag-list-count">1</span></a>
            
    </div>
<script>
document.onreadystatechange = () => {
  if (document.readyState === 'complete') {
    tagCloud('#tag-cloud-list a',  8 ,  20 );
  }
};

function tagCloud(where, min, max) {
  let iMax = 0;
  let iMin = 0;
  $(where).each(function() {
    let weight = Number($(this).attr("rel"));
    if(iMax < weight) iMax = weight;
    if(iMin > weight || iMin == 0) iMin = weight;
  });
  let step = (max - min)/(iMax - iMin);
  $(where).each(function() {
    let weight = $(this).attr("rel") - iMin;
    $(this).css({"font-size": min + (weight * step) + 'px'});
  });
};
</script>
</div>

      <div class="widget">
    <h3 class="widget-title"> 分类</h3>
    <div class="widget-body">
        <ul class="category-list">
            <li class="category-list-item"><a href="/categories/%E4%B8%80%E4%BA%9B%E6%83%B3%E6%B3%95/" class="category-list-link">一些想法</a><span class="category-list-count">3</span></li>
            <li class="category-list-item"><a href="/categories/%E4%BA%A7%E5%93%81%E6%96%B9%E6%B3%95/" class="category-list-link">产品方法</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="/categories/%E4%BA%A7%E5%93%81%E8%AE%BE%E8%AE%A1/" class="category-list-link">产品设计</a><span class="category-list-count">3</span></li>
            <li class="category-list-item"><a href="/categories/%E4%BB%A3%E7%A0%81/" class="category-list-link">代码</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/" class="category-list-link">数据统计</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="/categories/%E9%97%B2%E6%9A%87%E7%94%9F%E6%B4%BB/" class="category-list-link">闲暇生活</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="/categories/%E9%98%85%E8%AF%BB/" class="category-list-link">阅读</a><span class="category-list-count">1</span></li>
        </ul>
    </div>
</div>
      <div class="widget">
    <h3 class="widget-title"> 标签</h3>
    <div class="widget-body">
        <ul class="tag-list">
            
            
            <li class="tag-list-item"><a href="/tags/dc%E6%BC%AB%E7%94%BB/" class="tag-list-link">dc漫画</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/discord/" class="tag-list-link">discord</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/facebook/" class="tag-list-link">facebook</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/instagram/" class="tag-list-link">instagram</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/netflix/" class="tag-list-link">netflix</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E4%B8%AA%E6%80%A7%E5%8C%96%E6%8E%A8%E8%8D%90/" class="tag-list-link">个性化推荐</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E4%BA%92%E5%8A%A8/" class="tag-list-link">互动</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E4%BA%A7%E5%93%81/" class="tag-list-link">产品</a><span
                    class="tag-list-count">5</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E4%BA%A7%E5%93%81%E6%96%87%E6%A1%A3/" class="tag-list-link">产品文档</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E4%BB%A3%E7%A0%81/" class="tag-list-link">代码</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E5%85%83%E5%AE%87%E5%AE%99/" class="tag-list-link">元宇宙</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E5%A5%A5%E8%BF%90%E4%BC%9A/" class="tag-list-link">奥运会</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E6%83%B3%E6%B3%95/" class="tag-list-link">想法</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E6%89%8E%E5%85%8B-%E6%96%BD%E8%80%90%E5%BE%B7/" class="tag-list-link">扎克-施耐德</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/" class="tag-list-link">数据统计</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E6%AD%A3%E4%B9%89%E8%81%94%E7%9B%9F/" class="tag-list-link">正义联盟</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E6%B8%B8%E6%88%8F%E7%8E%A9%E6%B3%95/" class="tag-list-link">游戏玩法</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E7%94%B5%E5%BD%B1/" class="tag-list-link">电影</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E7%A4%BE%E4%BA%A4%E8%BD%AF%E4%BB%B6/" class="tag-list-link">社交软件</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E7%AE%97%E6%B3%95/" class="tag-list-link">算法</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/" class="tag-list-link">编程思想</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E8%AF%BB%E5%90%8E%E6%84%9F/" class="tag-list-link">读后感</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E8%B6%B3%E7%90%83/" class="tag-list-link">足球</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="/tags/%E8%BF%90%E8%90%A5/" class="tag-list-link">运营</a><span
                    class="tag-list-count">1</span></li>
            
        </ul>

    </div>
</div>
      
<div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
        <ul class="recent-post-list list-unstyled no-thumbnail">
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="/2021/08/tokoyo-kun/" class="title">奥运会超级变变变生成器</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2021-08-05 18:11:18 &#43;0800 CST" itemprop="datePublished">2021-08-05</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="/2021/08/product-and-code/" class="title">产品设计思想和面向对象编程</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2021-08-02 22:17:31 &#43;0800 CST" itemprop="datePublished">2021-08-02</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="/2021/07/netflix/" class="title">购买Netflix会员后知道的事情</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2021-07-09 10:23:47 &#43;0800 CST" itemprop="datePublished">2021-07-09</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="/2021/07/instagram_share/" class="title">《解密INSTAGRAM》读后分享</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2021-07-02 23:19:48 &#43;0800 CST" itemprop="datePublished">2021-07-02</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="/2021/06/socialgames/" class="title">游戏是社交的未来？</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2021-06-24 11:20:59 &#43;0800 CST" itemprop="datePublished">2021-06-24</time>
                    </p>
                </div>
            </li>
        </ul>
    </div>
</div>
  </div>
</aside>

    
    
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <h4 class="toc-title">文章目录</h4>
    <nav id="toc" class="js-toc toc">

    </nav>
  </div>
</aside>
<main class="main" role="main"><div class="content">
  <article id="-" class="article article-type-" itemscope
    itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      <h1 itemprop="name">
  <a
    class="article-title"
    href="/2021/08/tokoyo-kun/"
    >奥运会超级变变变生成器</a
  >
</h1>

      <div class="article-meta">
        
<span class="article-date">
  <i class="icon icon-calendar-check"></i>&nbsp;
<a href="/2021/08/tokoyo-kun/" class="article-date">
  <time datetime="2021-08-05 18:11:18 &#43;0800 CST" itemprop="datePublished">2021-08-05</time>
</a>
</span>
<span class="article-category">
  <i class="icon icon-folder"></i>&nbsp;
  <a class="article-category-link" href="/categories/%E4%BB%A3%E7%A0%81/"> 代码 </a>
</span>  
  <span class="article-tag">
    <i class="icon icon-tags"></i>&nbsp;
    <a class="article-tag-link" href="/tags/%E4%BB%A3%E7%A0%81/"> 代码 </a>
    <a class="article-tag-link" href="/tags/%E5%A5%A5%E8%BF%90%E4%BC%9A/"> 奥运会 </a>
  </span>

        <span class="post-comment"><i class="icon icon-comment"></i>&nbsp;<a href="/2021/08/tokoyo-kun/#comments"
            class="article-comment-link">评论</a></span>
		<span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 2182字</span>
		<span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 5分 </span>
      </div>
    </div>
    <div class="article-entry marked-body js-toc-content" itemprop="articleBody">
      <p>东京奥运会的超级变变变挺好玩，抖音上也有不少人做了模仿视频。</p>
<p>正好看到有人分享了日本小哥通过机器学习模仿摄像头生成视频的代码，修改后玩了一下，可以从视频生成，效果不错。</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gt62u9hmilj320g0mowh1.jpg" alt="image-20210805181354050"></p>
<p>最终视频效果地址：https://www.bilibili.com/video/BV1A64y1z7P4/</p>
<p>代码如下：</p>
<pre><code>import copy
from datetime import datetime
import math
import argparse

import cv2 as cv
import numpy as np
import mediapipe as mp

from utils import CvFpsCalc


def get_args():
    parser = argparse.ArgumentParser()

#parser.add_argument(&quot;--device&quot;, type=int, default=0)
parser.add_argument('--file', type=str, required=True, help=&quot;video file path&quot;)

parser.add_argument(&quot;--width&quot;, help='cap width', type=int, default=640)
parser.add_argument(&quot;--height&quot;, help='cap height', type=int, default=360)

parser.add_argument('--static_image_mode', action='store_true')
parser.add_argument(&quot;--model_complexity&quot;,
                    help='model_complexity(0,1(default),2)',
                    type=int,
                    default=1)
parser.add_argument(&quot;--min_detection_confidence&quot;,
                    help='min_detection_confidence',
                    type=float,
                    default=0.5)
parser.add_argument(&quot;--min_tracking_confidence&quot;,
                    help='min_tracking_confidence',
                    type=int,
                    default=0.5)

parser.add_argument('--rev_color', action='store_true')

args = parser.parse_args()

return args

def main():
    # 引数解析 #################################################################
    args = get_args()

print(args)

#cap_device = args.device
cap_file = args.file
cap_width = args.width
cap_height = args.height

static_image_mode = args.static_image_mode
model_complexity = args.model_complexity
min_detection_confidence = args.min_detection_confidence
min_tracking_confidence = args.min_tracking_confidence

rev_color = args.rev_color

# カメラ準備 ###############################################################
#cap = cv.VideoCapture(cap_device)
cap = cv.VideoCapture(cap_file)
cap.set(cv.CAP_PROP_FRAME_WIDTH, cap_width)
cap.set(cv.CAP_PROP_FRAME_HEIGHT, cap_height)

# モデルロード #############################################################
mp_pose = mp.solutions.pose
pose = mp_pose.Pose(
    static_image_mode=static_image_mode,
    model_complexity=model_complexity,
    min_detection_confidence=min_detection_confidence,
    min_tracking_confidence=min_tracking_confidence,
)

# FPS計測モジュール ########################################################
cvFpsCalc = CvFpsCalc(buffer_len=10)

# 色指定
if rev_color:
    color = (255, 255, 255)
    bg_color = (100, 33, 3)
else:
    color = (100, 33, 3)
    bg_color = (255, 255, 255)

is_first = True
output_video = None
while True:
    display_fps = cvFpsCalc.get()

    # カメラキャプチャ #####################################################
    ret, image = cap.read()
    if not ret:
        break
    #image = cv.flip(image, 1)  # ミラー表示
    #image = cv.flip(image, 1)  # ミラー表示
    debug_image01 = copy.deepcopy(image)
    debug_image02 = np.zeros((image.shape[0], image.shape[1], 3), np.uint8)
    cv.rectangle(debug_image02, (0, 0), (image.shape[1], image.shape[0]),
                bg_color,
                thickness=-1)

    # 検出実施 #############################################################
    image = cv.cvtColor(image, cv.COLOR_BGR2RGB)
    results = pose.process(image)

    # 描画 ################################################################
    if results.pose_landmarks is not None:
        # 描画
        debug_image01 = draw_landmarks(
            debug_image01,
            results.pose_landmarks,
        )
        debug_image02 = draw_stick_figure(
            debug_image02,
            results.pose_landmarks,
            color=color,
            bg_color=bg_color,
        )

    cv.putText(debug_image01, &quot;FPS:&quot; + str(display_fps), (10, 30),
               cv.FONT_HERSHEY_SIMPLEX, 1.0, (0, 255, 0), 2, cv.LINE_AA)
    cv.putText(debug_image02, &quot;FPS:&quot; + str(display_fps), (10, 30),
               cv.FONT_HERSHEY_SIMPLEX, 1.0, color, 2, cv.LINE_AA)

    # キー処理(ESC：終了) #################################################
    key = cv.waitKey(1)
    if key == 27:  # ESC
        break

    # 画面反映 #############################################################
    cv.imshow('Tokyo2020 Debug', debug_image01)
    cv.imshow('Tokyo2020 Pictogram', debug_image02)

    if is_first:
        fmt = cv.VideoWriter_fourcc('m', 'p', '4', 'v')
        fps = cap.get(cv.CAP_PROP_FPS)
        now = datetime.now().strftime('%Y-%m-%d-%H%M%S')
        output_video = cv.VideoWriter(f'{now}-pictgram-output.mp4', fmt, fps, (debug_image02.shape[1], debug_image02.shape[0]))
        is_first = False

    output_video.write(debug_image02)


cap.release()
if output_video:
    output_video.release()
cv.destroyAllWindows()
def draw_stick_figure(
        image,
        landmarks,
        color=(100, 33, 3),
        bg_color=(255, 255, 255),
        visibility_th=0.5,
):
    image_width, image_height = image.shape[1], image.shape[0]

# 各ランドマーク算出
landmark_point = []
for index, landmark in enumerate(landmarks.landmark):
    landmark_x = min(int(landmark.x * image_width), image_width - 1)
    landmark_y = min(int(landmark.y * image_height), image_height - 1)
    landmark_z = landmark.z
    landmark_point.append(
        [index, landmark.visibility, (landmark_x, landmark_y), landmark_z])

# 脚の付け根の位置を腰の中点に修正
right_leg = landmark_point[23]
left_leg = landmark_point[24]
leg_x = int((right_leg[2][0] + left_leg[2][0]) / 2)
leg_y = int((right_leg[2][1] + left_leg[2][1]) / 2)

landmark_point[23][2] = (leg_x, leg_y)
landmark_point[24][2] = (leg_x, leg_y)

# 距離順にソート
sorted_landmark_point = sorted(landmark_point,
                               reverse=True,
                               key=lambda x: x[3])

# 各サイズ算出
(face_x, face_y), face_radius = min_enclosing_face_circle(landmark_point)

face_x = int(face_x)
face_y = int(face_y)
face_radius = int(face_radius * 1.5)

stick_radius01 = int(face_radius * (4 / 5))
stick_radius02 = int(stick_radius01 * (3 / 4))
stick_radius03 = int(stick_radius02 * (3 / 4))

# 描画対象リスト
draw_list = [
    11,  # 右腕
    12,  # 左腕
    23,  # 右脚
    24,  # 左脚
]

# 背景色
cv.rectangle(image, (0, 0), (image_width, image_height),
             bg_color,
             thickness=-1)

# 顔 描画
cv.circle(image, (face_x, face_y), face_radius, color, -1)

# 腕/脚 描画
for landmark_info in sorted_landmark_point:
    index = landmark_info[0]

    if index in draw_list:
        point01 = [p for p in landmark_point if p[0] == index][0]
        point02 = [p for p in landmark_point if p[0] == (index + 2)][0]
        point03 = [p for p in landmark_point if p[0] == (index + 4)][0]

        if point01[1] &gt; visibility_th and point02[1] &gt; visibility_th:
            image = draw_stick(
                image,
                point01[2],
                stick_radius01,
                point02[2],
                stick_radius02,
                color=color,
                bg_color=bg_color,
            )
        if point02[1] &gt; visibility_th and point03[1] &gt; visibility_th:
            image = draw_stick(
                image,
                point02[2],
                stick_radius02,
                point03[2],
                stick_radius03,
                color=color,
                bg_color=bg_color,
            )

return image

def min_enclosing_face_circle(landmark_point):
    landmark_array = np.empty((0, 2), int)

index_list = [1, 4, 7, 8, 9, 10]
for index in index_list:
    np_landmark_point = [
        np.array(
            (landmark_point[index][2][0], landmark_point[index][2][1]))
    ]
    landmark_array = np.append(landmark_array, np_landmark_point, axis=0)

center, radius = cv.minEnclosingCircle(points=landmark_array)

return center, radius

def draw_stick(
        image,
        point01,
        point01_radius,
        point02,
        point02_radius,
        color=(100, 33, 3),
        bg_color=(255, 255, 255),
):
    cv.circle(image, point01, point01_radius, color, -1)
    cv.circle(image, point02, point02_radius, color, -1)

draw_list = []
for index in range(2):
    rad = math.atan2(point02[1] - point01[1], point02[0] - point01[0])

    rad = rad + (math.pi / 2) + (math.pi * index)
    point_x = int(point01_radius * math.cos(rad)) + point01[0]
    point_y = int(point01_radius * math.sin(rad)) + point01[1]

    draw_list.append([point_x, point_y])

    point_x = int(point02_radius * math.cos(rad)) + point02[0]
    point_y = int(point02_radius * math.sin(rad)) + point02[1]

    draw_list.append([point_x, point_y])

points = np.array((draw_list[0], draw_list[1], draw_list[3], draw_list[2]))
cv.fillConvexPoly(image, points=points, color=color)

return image

def draw_landmarks(
    image,
    landmarks,

    # upper_body_only,
      visibility_th=0.5,
):
    image_width, image_height = image.shape[1], image.shape[0]

landmark_point = []

for index, landmark in enumerate(landmarks.landmark):
    landmark_x = min(int(landmark.x * image_width), image_width - 1)
    landmark_y = min(int(landmark.y * image_height), image_height - 1)
    landmark_z = landmark.z
    landmark_point.append([landmark.visibility, (landmark_x, landmark_y)])

    if landmark.visibility &lt; visibility_th:
        continue

    if index == 0:  # 鼻
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 1:  # 右目：目頭
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 2:  # 右目：瞳
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 3:  # 右目：目尻
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 4:  # 左目：目頭
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 5:  # 左目：瞳
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 6:  # 左目：目尻
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 7:  # 右耳
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 8:  # 左耳
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 9:  # 口：左端
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 10:  # 口：左端
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 11:  # 右肩
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 12:  # 左肩
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 13:  # 右肘
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 14:  # 左肘
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 15:  # 右手首
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 16:  # 左手首
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 17:  # 右手1(外側端)
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 18:  # 左手1(外側端)
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 19:  # 右手2(先端)
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 20:  # 左手2(先端)
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 21:  # 右手3(内側端)
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 22:  # 左手3(内側端)
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 23:  # 腰(右側)
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 24:  # 腰(左側)
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 25:  # 右ひざ
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 26:  # 左ひざ
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 27:  # 右足首
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 28:  # 左足首
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 29:  # 右かかと
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 30:  # 左かかと
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 31:  # 右つま先
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)
    if index == 32:  # 左つま先
        cv.circle(image, (landmark_x, landmark_y), 5, (0, 255, 0), 2)

    # if not upper_body_only:
    if True:
        cv.putText(image, &quot;z:&quot; + str(round(landmark_z, 3)),
                   (landmark_x - 10, landmark_y - 10),
                   cv.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 1,
                   cv.LINE_AA)

# 右目
if landmark_point[1][0] &gt; visibility_th and landmark_point[2][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[1][1], landmark_point[2][1],
            (0, 255, 0), 2)
if landmark_point[2][0] &gt; visibility_th and landmark_point[3][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[2][1], landmark_point[3][1],
            (0, 255, 0), 2)

# 左目
if landmark_point[4][0] &gt; visibility_th and landmark_point[5][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[4][1], landmark_point[5][1],
            (0, 255, 0), 2)
if landmark_point[5][0] &gt; visibility_th and landmark_point[6][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[5][1], landmark_point[6][1],
            (0, 255, 0), 2)

# 口
if landmark_point[9][0] &gt; visibility_th and landmark_point[10][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[9][1], landmark_point[10][1],
            (0, 255, 0), 2)

# 肩
if landmark_point[11][0] &gt; visibility_th and landmark_point[12][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[11][1], landmark_point[12][1],
            (0, 255, 0), 2)

# 右腕
if landmark_point[11][0] &gt; visibility_th and landmark_point[13][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[11][1], landmark_point[13][1],
            (0, 255, 0), 2)
if landmark_point[13][0] &gt; visibility_th and landmark_point[15][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[13][1], landmark_point[15][1],
            (0, 255, 0), 2)

# 左腕
if landmark_point[12][0] &gt; visibility_th and landmark_point[14][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[12][1], landmark_point[14][1],
            (0, 255, 0), 2)
if landmark_point[14][0] &gt; visibility_th and landmark_point[16][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[14][1], landmark_point[16][1],
            (0, 255, 0), 2)

# 右手
if landmark_point[15][0] &gt; visibility_th and landmark_point[17][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[15][1], landmark_point[17][1],
            (0, 255, 0), 2)
if landmark_point[17][0] &gt; visibility_th and landmark_point[19][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[17][1], landmark_point[19][1],
            (0, 255, 0), 2)
if landmark_point[19][0] &gt; visibility_th and landmark_point[21][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[19][1], landmark_point[21][1],
            (0, 255, 0), 2)
if landmark_point[21][0] &gt; visibility_th and landmark_point[15][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[21][1], landmark_point[15][1],
            (0, 255, 0), 2)

# 左手
if landmark_point[16][0] &gt; visibility_th and landmark_point[18][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[16][1], landmark_point[18][1],
            (0, 255, 0), 2)
if landmark_point[18][0] &gt; visibility_th and landmark_point[20][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[18][1], landmark_point[20][1],
            (0, 255, 0), 2)
if landmark_point[20][0] &gt; visibility_th and landmark_point[22][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[20][1], landmark_point[22][1],
            (0, 255, 0), 2)
if landmark_point[22][0] &gt; visibility_th and landmark_point[16][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[22][1], landmark_point[16][1],
            (0, 255, 0), 2)

# 胴体
if landmark_point[11][0] &gt; visibility_th and landmark_point[23][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[11][1], landmark_point[23][1],
            (0, 255, 0), 2)
if landmark_point[12][0] &gt; visibility_th and landmark_point[24][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[12][1], landmark_point[24][1],
            (0, 255, 0), 2)
if landmark_point[23][0] &gt; visibility_th and landmark_point[24][
        0] &gt; visibility_th:
    cv.line(image, landmark_point[23][1], landmark_point[24][1],
            (0, 255, 0), 2)

if len(landmark_point) &gt; 25:
    # 右足
    if landmark_point[23][0] &gt; visibility_th and landmark_point[25][
            0] &gt; visibility_th:
        cv.line(image, landmark_point[23][1], landmark_point[25][1],
                (0, 255, 0), 2)
    if landmark_point[25][0] &gt; visibility_th and landmark_point[27][
            0] &gt; visibility_th:
        cv.line(image, landmark_point[25][1], landmark_point[27][1],
                (0, 255, 0), 2)
    if landmark_point[27][0] &gt; visibility_th and landmark_point[29][
            0] &gt; visibility_th:
        cv.line(image, landmark_point[27][1], landmark_point[29][1],
                (0, 255, 0), 2)
    if landmark_point[29][0] &gt; visibility_th and landmark_point[31][
            0] &gt; visibility_th:
        cv.line(image, landmark_point[29][1], landmark_point[31][1],
                (0, 255, 0), 2)

    # 左足
    if landmark_point[24][0] &gt; visibility_th and landmark_point[26][
            0] &gt; visibility_th:
        cv.line(image, landmark_point[24][1], landmark_point[26][1],
                (0, 255, 0), 2)
    if landmark_point[26][0] &gt; visibility_th and landmark_point[28][
            0] &gt; visibility_th:
        cv.line(image, landmark_point[26][1], landmark_point[28][1],
                (0, 255, 0), 2)
    if landmark_point[28][0] &gt; visibility_th and landmark_point[30][
            0] &gt; visibility_th:
        cv.line(image, landmark_point[28][1], landmark_point[30][1],
                (0, 255, 0), 2)
    if landmark_point[30][0] &gt; visibility_th and landmark_point[32][
            0] &gt; visibility_th:
        cv.line(image, landmark_point[30][1], landmark_point[32][1],
                (0, 255, 0), 2)
return image

if __name__ == '__main__':
    main()`
</code></pre>
<p>日本小哥的项目地址：<a href="">https://github.com/Kazuhito00/Tokyo2020-Pictogram-using-MediaPipe</a></p>

    </div>
    <div class="article-footer">


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://weibo.com/u/3486501484" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://weibo.com/u/3486501484" target="_blank"><span class="text-dark">J4Muke</span><small class="ml-1x">产品经理</small></a></h3>
        <div>Being Productive. Being Useful.</div>
      </div>
    </figure>
  </div>
</div>
    </div>
  </article>
<section id="comments">
    <div id="vcomments"></div>
</section>

</div><nav class="bar bar-footer clearfix" data-stick-bottom>
    <div class="bar-inner">
        <ul class="pager pull-left">
            <li class="prev">
                <a href="/2021/08/product-and-code/" title="产品设计思想和面向对象编程"><i
                        class="icon icon-angle-left"
                        aria-hidden="true"></i><span>&nbsp;&nbsp;下一篇</span></a>
            </li>
            
            <li class="toggle-toc">
                <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false"
                    title="文章目录" role="button">
                    <span>[&nbsp;</span><span>文章目录</span>
                    <i class="text-collapsed icon icon-anchor"></i>
                    <i class="text-in icon icon-close"></i>
                    <span>]</span>
                </a>
            </li>
        </ul>
        <div class="bar-right">
            <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter"
                data-mobile-sites="weibo,qq,qzone,wechat"></div>
        </div>
    </div>
</nav>


</main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
<ul class="social-links">
    <li><a href="/index.xml" target="_blank" title="rss" data-toggle=tooltip data-placement=top >
            <i class="icon icon-rss"></i></a></li>
    <li><a href="https://weibo.com/u/3486501484" target="_blank" title="weibo" data-toggle=tooltip data-placement=top >
            <i class="icon icon-weibo"></i></a></li>
</ul>
  <div class="copyright">
    &copy;2021  -
    2021
    <div class="publishby">
        Being Productive. Being Useful.
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/python.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/javascript.min.js" defer></script><script>
    hljs.configure({
        tabReplace: '    ', 
        classPrefix: ''     
        
    })
    hljs.initHighlightingOnLoad();
</script>
<script src="/js/application.min.a94ab19cb63a95c8d7fbd7b85cab3ddeea8c369bdf75b9cab6708787ead123af.js"></script>
<script src="/js/plugin.min.19c5bcb2fb0789ab4f2b7834e5ceb5e92635645605bab902c1024b25f1502364.js"></script>

<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(未命名)',
            },
            ROOT_URL: '\/',
            CONTENT_URL: '\/\/searchindex.json ',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script type="text/javascript" src="/js/insight.min.4a2d52de4bfff73e0c688404fe3d17c9a3ae12d9888e1e1ac9c690e4890de2ded50fe55f2b819c2ba55435a76f396f3ea6805765f0b0af5635cdf74ea459eab0.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3',
        
        hasInnerContainers: true,
    });
</script>

<script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine"></script>
<script type="text/javascript">
    var GUEST = ['nick', 'mail', 'link'];
    var meta = 'nick,mail';
    meta = meta.split(',').filter(function (item) {
        return GUEST.indexOf(item) > -1;
    });
    new Valine({
        el: '#vcomments',
        verify: null ,
        notify: null ,
        appId: '2cGSWev1Oh89OFSgJVSBn5PH-gzGzoHsz',
        appKey: 'tJ7wkRjmOgJJIjYh6dEqXoJ0',
        placeholder: '你想对我说点什么呢？',
        avatar: 'mm',
        meta: meta,
        pageSize: '10' || 10,
        visitor: false 
});
</script>

  </body>
</html>
